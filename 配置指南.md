# 微信公众号配置完整指南

## 📝 配置信息

### 服务器Token
```
Zywl2025
```

### 配置URL
```
https://admin.xintuxiangce.top/api/v1/auth/wechat/verify
```

## 🔧 配置步骤

### 第1步：登录微信公众平台
1. 访问：https://mp.weixin.qq.com/
2. 使用管理员账号登录

### 第2步：进入配置页面
1. 点击左侧菜单「开发」
2. 点击「基本配置」
3. 找到「服务器配置」部分

### 第3步：填写配置信息

#### 1. URL（服务器地址）
```
https://admin.xintuxiangce.top/api/v1/auth/wechat/verify
```

#### 2. Token（令牌）
```
Zywl2025
```

#### 3. EncodingAESKey（消息加解密密钥）
```
留空（不填写）
```

#### 4. 消息加解密方式
```
选择：明文模式
⚠️ 重要：必须选择明文模式，不要选择兼容模式或安全模式
```

### 第4步：提交验证
1. 填写完所有信息后
2. 点击「提交」按钮
3. 等待验证结果

### 第5步：查看结果

#### ✅ 成功
- 显示"配置成功"
- 显示"服务器配置已启用"
- 可以开始测试功能

#### ❌ 失败
如果显示"验证失败"或"返回非200"：

1. **检查Token**
   - 确认Token是否正确输入：`Zywl2025`
   - 注意大小写要一致

2. **检查加密模式**
   - 必须是"明文模式"
   - 不要选择"兼容模式"或"安全模式"

3. **检查URL**
   - 确认URL是否完整
   - 确认使用了 HTTPS
   - 确认没有多余的空格

4. **查看服务器日志**
   ```bash
   ssh root@123.57.68.4 "tail -50 /tmp/app.log"
   ```

## 🔍 常见问题

### Q1: 为什么提示"验证失败"？
A: 可能是Token不匹配或加密模式选择错误。

### Q2: 为什么提示"返回非200"？
A: 可能是选择了兼容模式或安全模式，需要改为明文模式。

### Q3: 如何查看详细的错误信息？
A: 在服务器上查看日志：
```bash
ssh root@123.57.68.4 "tail -f /tmp/app.log"
```

## ✅ 配置成功后的测试

配置成功后，可以测试二维码功能：

```bash
curl -X POST https://admin.xintuxiangce.top/api/v1/auth/wechat/qrcode \
  -H "Content-Type: application/json" \
  -d '{"client_id": "test_001"}'
```

## 📌 重要提醒

1. **Token必须完全一致**（包括大小写）
2. **必须选择明文模式**
3. **URL必须使用HTTPS**
4. **配置前确保服务正在运行**
