# å®¢æˆ·ç«¯è°ƒç”¨æŒ‡å—

## ğŸ“‹ APIåŸºæœ¬ä¿¡æ¯

**æœåŠ¡å™¨åœ°å€**ï¼š`http://123.57.68.4:8000`

**æ ¸å¿ƒæ¥å£**ï¼š

### ğŸ¥ åŸºç¡€æœåŠ¡
1. `GET /api/v1/health` - å¥åº·æ£€æŸ¥ï¼ˆåº”ç”¨å¯åŠ¨æ—¶è°ƒç”¨ï¼‰

### ğŸ–¼ï¸ å›¾ç‰‡åˆ†ç±»æœåŠ¡
2. `POST /api/v1/classify/check-cache` - æŸ¥è¯¢ç¼“å­˜ï¼ˆæ¨èå…ˆè°ƒç”¨ï¼‰
3. `POST /api/v1/classify` - å›¾ç‰‡åˆ†ç±»ï¼ˆè‡ªåŠ¨é€‰æ‹©å¤§æ¨¡å‹æˆ–å°æ¨¡å‹ï¼‰
4. `POST /api/v1/classify/batch-check-cache` - æ‰¹é‡æŸ¥è¯¢ç¼“å­˜ï¼ˆæœ€å¤š100ä¸ªï¼‰
5. `POST /api/v1/classify/batch` - æ‰¹é‡å›¾ç‰‡åˆ†ç±»ï¼ˆæœ€å¤š20å¼ ï¼‰

### ğŸ“ åœ°ç†ä½ç½®æœåŠ¡
6. `GET /api/v1/location/nearest-city` - æŸ¥è¯¢æœ€è¿‘çš„åŸå¸‚
7. `GET /api/v1/location/nearby-cities` - æŸ¥è¯¢é™„è¿‘åŸå¸‚åˆ—è¡¨

### ğŸ¨ å›¾åƒç¼–è¾‘æœåŠ¡
8. `POST /api/v1/image-edit/submit` - æäº¤å›¾åƒç¼–è¾‘ä»»åŠ¡ï¼ˆ1-9å¼ ï¼‰
9. `GET /api/v1/image-edit/task/{task_id}` - æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€

### ğŸ” å¾®ä¿¡è®¤è¯ä¸é¢åº¦ç®¡ç†ï¼ˆåŸºäºclient_idï¼‰
10. `POST /api/v1/auth/wechat/qrcode` - ç”Ÿæˆå¾®ä¿¡å…¬ä¼—å·äºŒç»´ç ï¼ˆæ‰«ç å…³æ³¨ï¼‰
11. `GET /api/v1/auth/wechat/check-follow?client_id=...` - æ£€æŸ¥æ˜¯å¦å·²å…³æ³¨ï¼ˆä¸è¿”å›openidï¼‰
12. `GET /api/v1/user/member-status?client_id=...` - æŸ¥è¯¢ä¼šå‘˜çŠ¶æ€
13. `GET /api/v1/user/credits?client_id=...` - æŸ¥è¯¢ç”¨æˆ·é¢åº¦

---

## ğŸ¯ æ¨èè°ƒç”¨æµç¨‹

### å•å¼ å›¾ç‰‡åˆ†ç±»

```
åº”ç”¨å¯åŠ¨æ—¶ï¼š
â”œâ”€ è°ƒç”¨ /health æ£€æŸ¥æœåŠ¡å¯ç”¨æ€§
â””â”€ å¦‚æœæœåŠ¡ä¸å¯ç”¨ â†’ æç¤ºç”¨æˆ·

ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡æ—¶ï¼š
1. è®¡ç®—åŸå›¾SHA-256å“ˆå¸Œ
   â†“
2. è°ƒç”¨ /check-cache æŸ¥è¯¢ç¼“å­˜
   â”œâ”€ ç¼“å­˜å‘½ä¸­ â†’ ç›´æ¥ä½¿ç”¨ç»“æœ âœ…ï¼ˆçœå¸¦å®½100%ï¼Œçœç¼©æ”¾æ“ä½œï¼ï¼‰
   â””â”€ ç¼“å­˜æœªå‘½ä¸­ â†’ ç»§ç»­æ­¥éª¤3
   â†“
3. å®¢æˆ·ç«¯ç¼©æ”¾å›¾ç‰‡ï¼ˆ**å¿…é¡»**ï¼š1024pxé•¿è¾¹ï¼Œä¿æŒå®½é«˜æ¯”ï¼Œ80%è´¨é‡ï¼ŒJPEGæ ¼å¼ï¼‰
   â†“
4. è°ƒç”¨ /classify ä¸Šä¼ å›¾ç‰‡ï¼ˆå¸¦ä¸Šæ­¥éª¤1çš„å“ˆå¸Œï¼‰
   â†“
5. è·å–åˆ†ç±»ç»“æœ
```

### æ‰¹é‡å›¾ç‰‡åˆ†ç±»ï¼ˆæ¨èï¼šç›¸å†Œå¯¼å…¥åœºæ™¯ï¼‰

```
ç”¨æˆ·æ‰¹é‡ä¸Šä¼ å›¾ç‰‡æ—¶ï¼š
1. è®¡ç®—æ‰€æœ‰åŸå›¾SHA-256å“ˆå¸Œ
   â†“
2. è°ƒç”¨ /batch-check-cache æ‰¹é‡æŸ¥è¯¢ç¼“å­˜ï¼ˆæœ€å¤š100ä¸ªï¼‰
   â”œâ”€ æå–ç¼“å­˜å‘½ä¸­çš„ç»“æœ âœ…
   â””â”€ ç­›é€‰å‡ºæœªå‘½ä¸­çš„å›¾ç‰‡
   â†“
3. å¯¹æœªå‘½ä¸­çš„å›¾ç‰‡è¿›è¡Œç¼©æ”¾ï¼ˆ1024pxé•¿è¾¹ï¼Œä¿æŒå®½é«˜æ¯”ï¼‰
   â†“
4. è°ƒç”¨ /batch æ‰¹é‡ä¸Šä¼ ï¼ˆæœ€å¤š20å¼ ï¼Œå¯åˆ†æ‰¹ï¼‰
   â†“
5. åˆå¹¶ç¼“å­˜ç»“æœå’Œä¸Šä¼ ç»“æœ
   â†“
6. è¿”å›å®Œæ•´çš„åˆ†ç±»ç»“æœåˆ—è¡¨
```

**æ‰¹é‡ä¼˜åŠ¿**ï¼š
- ğŸš€ å‡å°‘ç½‘ç»œè¯·æ±‚æ¬¡æ•°ï¼ˆNæ¬¡ â†’ 2-3æ¬¡ï¼‰
- ğŸ’¾ å……åˆ†åˆ©ç”¨ç¼“å­˜ï¼ˆå…ˆæ‰¹é‡æŸ¥è¯¢ï¼Œåªä¸Šä¼ å¿…è¦çš„å›¾ç‰‡ï¼‰
- âš¡ æå‡å¤„ç†é€Ÿåº¦ï¼ˆå¹¶è¡Œå¤„ç†ï¼‰
- ğŸ“Š æ›´å¥½çš„é”™è¯¯å¤„ç†ï¼ˆéƒ¨åˆ†å¤±è´¥ä¸å½±å“æ•´ä½“ï¼‰

---

## ğŸ¥ å¥åº·æ£€æŸ¥æ¥å£

### æ¥å£è§„èŒƒ

```http
GET /api/v1/health
```

### å“åº”æ ¼å¼

```json
{
  "status": "healthy",
  "timestamp": "2025-10-10T12:00:00Z",
  "database": "connected",
  "model_api": "available"
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| status | string | æ•´ä½“çŠ¶æ€ï¼š`healthy` / `unhealthy` |
| database | string | æ•°æ®åº“çŠ¶æ€ï¼š`connected` / `disconnected` |
| model_api | string | å¤§æ¨¡å‹APIçŠ¶æ€ï¼š`available` / `not_configured` |
| timestamp | string | æ£€æŸ¥æ—¶é—´ï¼ˆISO 8601æ ¼å¼ï¼‰ |

---

## ğŸ” æŸ¥è¯¢ç¼“å­˜æ¥å£

### æ¥å£è§„èŒƒ

```http
POST /api/v1/classify/check-cache
Content-Type: application/json
X-User-ID: {user_id}  // å¯é€‰
```

### è¯·æ±‚å‚æ•°

```json
{
  "image_hash": "abc123..."  // å¿…å¡«ï¼šå›¾ç‰‡SHA-256å“ˆå¸Œ
}
```

### å“åº”æ ¼å¼

**ç¼“å­˜å‘½ä¸­**ï¼š
```json
{
  "cached": true,
  "data": {
    "category": "foods",
    "confidence": 0.92,
    "description": "ä¸€ç›˜ç¾å‘³çš„æ„å¤§åˆ©é¢"
  },
  "request_id": "req_xxx"
}
```

**ç¼“å­˜æœªå‘½ä¸­**ï¼š
```json
{
  "cached": false
}
```

---

## ğŸ“¦ æ‰¹é‡æŸ¥è¯¢ç¼“å­˜æ¥å£

### æ¥å£è§„èŒƒ

```http
POST /api/v1/classify/batch-check-cache
Content-Type: application/json
X-User-ID: {user_id}  // å¯é€‰
```

### è¯·æ±‚å‚æ•°

```json
{
  "image_hashes": [
    "abc123...",  // SHA-256å“ˆå¸Œ1
    "def456...",  // SHA-256å“ˆå¸Œ2
    "ghi789..."   // SHA-256å“ˆå¸Œ3
  ]
}
```

**é™åˆ¶**ï¼š
- æœ€å°‘ï¼š1ä¸ªå“ˆå¸Œ
- æœ€å¤šï¼š100ä¸ªå“ˆå¸Œ

### å“åº”æ ¼å¼

```json
{
  "success": true,
  "total": 3,
  "cached_count": 2,
  "items": [
    {
      "image_hash": "abc123...",
      "cached": true,
      "data": {
        "category": "foods",
        "confidence": 0.92,
        "description": "ç¾é£Ÿç…§ç‰‡"
      }
    },
    {
      "image_hash": "def456...",
      "cached": true,
      "data": {
        "category": "pets",
        "confidence": 0.88,
        "description": "å® ç‰©ç…§ç‰‡"
      }
    },
    {
      "image_hash": "ghi789...",
      "cached": false,
      "data": null
    }
  ],
  "request_id": "req_xxx",
  "timestamp": "2025-10-13T18:45:28Z"
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| total | int | æŸ¥è¯¢æ€»æ•° |
| cached_count | int | ç¼“å­˜å‘½ä¸­æ•° |
| items | array | ç¼“å­˜é¡¹åˆ—è¡¨ |
| items[].image_hash | string | å›¾ç‰‡å“ˆå¸Œå€¼ |
| items[].cached | boolean | æ˜¯å¦æœ‰ç¼“å­˜ |
| items[].data | object/null | åˆ†ç±»æ•°æ®ï¼ˆæœ‰ç¼“å­˜æ—¶ï¼‰ |

---

## ğŸ“¸ æ‰¹é‡å›¾ç‰‡åˆ†ç±»æ¥å£

### æ¥å£è§„èŒƒ

```http
POST /api/v1/classify/batch
Content-Type: multipart/form-data
X-User-ID: {user_id}  // å¯é€‰
```

### è¯·æ±‚å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| images | File[] | æ˜¯ | å›¾ç‰‡æ–‡ä»¶æ•°ç»„ï¼ˆæœ€å¤š20å¼ ï¼‰ |
| image_hashes | string | å¦ | å“ˆå¸Œåˆ—è¡¨JSONå­—ç¬¦ä¸² |

**image_hashesæ ¼å¼**ï¼š
```json
["hash1", "hash2", "hash3"]
```

### å“åº”æ ¼å¼

**ç¤ºä¾‹1ï¼šæ··åˆæ¨ç†ç»“æœ**
```json
{
  "success": true,
  "total": 4,
  "success_count": 3,
  "fail_count": 1,
  "items": [
    {
      "index": 0,
      "filename": "photo1.jpg",
      "success": true,
      "data": {
        "category": "foods",
        "confidence": 0.92,
        "description": "ç¾é£Ÿç…§ç‰‡",
        "local_inference_result": null
      },
      "error": null,
      "from_cache": false,
      "processing_time_ms": 1234
    },
    {
      "index": 1,
      "filename": "photo2.jpg",
      "success": true,
      "data": {
        "category": "",
        "confidence": 0.8,
        "description": "å°æ¨¡å‹æ¨ç†ç»“æœ",
        "local_inference_result": {
          "success": true,
          "idCardDetections": [],
          "generalDetections": [
            {
              "classId": 0,
              "className": "person",
              "confidence": 0.85,
              "bbox": [100.0, 150.0, 200.0, 300.0]
            }
          ],
          "mobileNetV3Detections": {
            "success": true,
            "predictions": [...],
            "topPrediction": {...},
            "confidence": 0.75
          }
        }
      },
      "error": null,
      "from_cache": false,
      "processing_time_ms": 342
    },
    {
      "index": 2,
      "filename": "photo3.jpg",
      "success": true,
      "data": {
        "category": "pets",
        "confidence": 0.88,
        "description": "å® ç‰©ç…§ç‰‡",
        "local_inference_result": null
      },
      "error": null,
      "from_cache": true,
      "processing_time_ms": 45
    },
    {
      "index": 3,
      "filename": "photo4.jpg",
      "success": false,
      "data": null,
      "error": "å›¾ç‰‡æ ¼å¼é”™è¯¯",
      "from_cache": false,
      "processing_time_ms": 20
    }
  ],
  "request_id": "req_xxx",
  "total_processing_time_ms": 1641,
  "timestamp": "2025-10-13T18:53:25Z"
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| total | int | å›¾ç‰‡æ€»æ•° |
| success_count | int | æˆåŠŸæ•° |
| fail_count | int | å¤±è´¥æ•° |
| items | array | åˆ†ç±»ç»“æœåˆ—è¡¨ |
| items[].index | int | å›¾ç‰‡ç´¢å¼• |
| items[].filename | string | æ–‡ä»¶å |
| items[].success | boolean | æ˜¯å¦æˆåŠŸ |
| items[].data | object/null | åˆ†ç±»æ•°æ® |
| items[].data.category | string | åˆ†ç±»ç±»åˆ«ï¼ˆç©ºå­—ç¬¦ä¸²è¡¨ç¤ºå°æ¨¡å‹æ¨ç†ï¼‰ |
| items[].data.local_inference_result | object/null | å°æ¨¡å‹æ¨ç†åŸå§‹ç»“æœ |
| items[].error | string/null | é”™è¯¯ä¿¡æ¯ |
| items[].from_cache | boolean | æ˜¯å¦æ¥è‡ªç¼“å­˜ |
| items[].processing_time_ms | int | å•å¼ å¤„ç†è€—æ—¶ |
| total_processing_time_ms | int | æ€»å¤„ç†è€—æ—¶ |

**é‡è¦è¯´æ˜**ï¼š
- æ‰¹é‡åˆ†ç±»æ”¯æŒæ··åˆæ¨ç†ï¼ˆå¤§æ¨¡å‹ + å°æ¨¡å‹ï¼‰
- å½“ `data.category` ä¸ºç©ºä¸” `data.local_inference_result` å­˜åœ¨æ—¶ï¼Œè¡¨ç¤ºè¯¥å›¾ç‰‡ä½¿ç”¨äº†å°æ¨¡å‹æ¨ç†
- å®¢æˆ·ç«¯éœ€è¦å¯¹å°æ¨¡å‹æ¨ç†ç»“æœè¿›è¡Œæ˜ å°„å¤„ç†ï¼ˆå‚è€ƒå•å¼ åˆ†ç±»æ¥å£çš„å¤„ç†æ–¹å¼ï¼‰

---

## ğŸ–¼ï¸ å›¾ç‰‡åˆ†ç±»æ¥å£

### æ¥å£è§„èŒƒ

```http
POST /api/v1/classify
Content-Type: multipart/form-data
X-User-ID: {user_id}  // å¯é€‰
```

### è¯·æ±‚å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| image | File | æ˜¯ | å›¾ç‰‡æ–‡ä»¶ï¼ˆ**å¿…é¡»**ç¼©æ”¾åˆ°1024pxé•¿è¾¹ï¼Œä¿æŒå®½é«˜æ¯”ï¼‰ |
| image_hash | string | æ˜¯ | åŸå›¾SHA-256å“ˆå¸Œå€¼ |

### å“åº”æ ¼å¼

**å¤§æ¨¡å‹æ¨ç†**ï¼š
```json
{
  "success": true,
  "data": {
    "category": "foods",
    "confidence": 0.92,
    "description": "ä¸€ç›˜ç¾å‘³çš„æ„å¤§åˆ©é¢"
  },
  "from_cache": false,
  "processing_time_ms": 1523,
  "request_id": "req_xxx",
  "timestamp": "2025-10-10T12:00:00Z"
}
```

**å°æ¨¡å‹æ¨ç†**ï¼ˆéœ€å®¢æˆ·ç«¯æ˜ å°„ï¼‰ï¼š
```json
{
  "success": true,
  "data": {
    "category": "",  // ç©ºå­—ç¬¦ä¸²æ ‡è¯†éœ€è¦å®¢æˆ·ç«¯æ˜ å°„
    "confidence": 0.8,
    "description": "å°æ¨¡å‹æ¨ç†ç»“æœ",
    "local_inference_result": {
      "success": true,
      "message": "æ¨¡å‹æ¨ç†å®Œæˆ",
      "idCardDetections": [
        {
          "classId": 0,
          "className": "id_card_front",
          "confidence": 0.95,
          "bbox": [320.5, 240.2, 400.8, 250.3]  // [x, y, width, height]
        }
      ],
      "generalDetections": [
        {
          "classId": 0,
          "className": "person",
          "confidence": 0.85,
          "bbox": [100.0, 150.0, 200.0, 300.0]
        },
        {
          "classId": 15,
          "className": "cat",
          "confidence": 0.78,
          "bbox": [450.0, 200.0, 150.0, 180.0]
        }
      ],
      "mobileNetV3Detections": {
        "success": true,
        "predictions": [  // Top-5é¢„æµ‹ç»“æœ
          {
            "index": 285,
            "probability": 0.42,
            "class": "Egyptian cat"
          },
          {
            "index": 340,
            "probability": 0.18,
            "class": "zebra"
          },
          {
            "index": 154,
            "probability": 0.12,
            "class": "Pekinese"
          },
          {
            "index": 89,
            "probability": 0.08,
            "class": "sulphur-crested cockatoo"
          },
          {
            "index": 456,
            "probability": 0.05,
            "class": "bow tie"
          }
        ],
        "validPredictions": [  // ç½®ä¿¡åº¦â‰¥é˜ˆå€¼(0.3)çš„ç»“æœ
          {
            "index": 285,
            "probability": 0.42,
            "class": "Egyptian cat"
          }
        ],
        "topPrediction": {  // æœ€é«˜æ¦‚ç‡çš„é¢„æµ‹
          "index": 285,
          "probability": 0.42,
          "class": "Egyptian cat"
        },
        "confidence": 0.42  // æœ€é«˜ç½®ä¿¡åº¦
      }
    }
  },
  "from_cache": false,
  "processing_time_ms": 342,
  "request_id": "req_xxx",
  "timestamp": "2025-10-10T12:00:00Z"
}
```

**å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µè·¯å¾„ | ç±»å‹ | è¯´æ˜ |
|---------|------|------|
| `local_inference_result.idCardDetections` | array | IDå¡æ£€æµ‹ç»“æœæ•°ç»„ |
| `local_inference_result.generalDetections` | array | é€šç”¨ç‰©ä½“æ£€æµ‹ç»“æœæ•°ç»„ï¼ˆYOLO8sï¼Œ80ç±»ï¼‰ |
| `local_inference_result.mobileNetV3Detections` | object | MobileNetV3åˆ†ç±»ç»“æœå¯¹è±¡ |

**æ£€æµ‹å¯¹è±¡ç»“æ„**ï¼š
```javascript
{
  classId: number,      // ç±»åˆ«ID
  className: string,    // ç±»åˆ«åç§°ï¼ˆè‹±æ–‡ï¼‰
  confidence: number,   // ç½®ä¿¡åº¦ (0-1)
  bbox: [x, y, w, h]   // è¾¹ç•Œæ¡† [ä¸­å¿ƒx, ä¸­å¿ƒy, å®½åº¦, é«˜åº¦]
}
```

**MobileNetV3ç»“æœç»“æ„**ï¼š
```javascript
{
  success: boolean,          // æ¨ç†æ˜¯å¦æˆåŠŸ
  predictions: [             // Top-5é¢„æµ‹ç»“æœï¼ˆæŒ‰æ¦‚ç‡é™åºï¼‰
    {
      index: number,         // ImageNetç±»åˆ«ç´¢å¼• (0-999)
      probability: number,   // æ¦‚ç‡ (0-1)
      class: string          // ç±»åˆ«åç§°ï¼ˆå¦‚ "Egyptian cat"ï¼‰
    }
    // ... å…±5ä¸ªé¢„æµ‹ç»“æœ
  ],
  validPredictions: [...],   // ç½®ä¿¡åº¦â‰¥é˜ˆå€¼(0.3)çš„é¢„æµ‹ç»“æœ
  topPrediction: {...},      // æœ€é«˜æ¦‚ç‡çš„é¢„æµ‹ï¼ˆpredictions[0]ï¼‰
  confidence: number         // æœ€é«˜ç½®ä¿¡åº¦
}
```

### åˆ†ç±»ç±»åˆ«

| ç±»åˆ«Key | ä¸­æ–‡åç§° | è¯´æ˜ |
|---------|----------|------|
| social_activities | ç¤¾äº¤æ´»åŠ¨ | å¤šäººåˆç…§ã€èšä¼šç­‰ |
| pets | å® ç‰©èŒç…§ | çŒ«ã€ç‹—ã€é¸Ÿç­‰å® ç‰© |
| single_person | å•äººç…§ç‰‡ | å•äººè‚–åƒã€è‡ªæ‹ç­‰ |
| foods | ç¾é£Ÿè®°å½• | é£Ÿç‰©ã€é¤é¥®ç…§ç‰‡ |
| travel_scenery | æ—…è¡Œé£æ™¯ | é£æ™¯ã€å»ºç­‘ã€æ—…æ¸¸ç…§ç‰‡ |
| screenshot | æ‰‹æœºæˆªå›¾ | æ‰‹æœºå±å¹•æˆªå›¾ |
| idcard | è¯ä»¶ç…§ | èº«ä»½è¯ã€è¯ä»¶ç±»ç…§ç‰‡ |
| other | å…¶å®ƒ | æ— æ³•æ˜ç¡®åˆ†ç±»çš„ç…§ç‰‡ |

---

## ğŸ“ åœ°ç†ä½ç½®æ¥å£

### 1. æŸ¥è¯¢æœ€è¿‘çš„åŸå¸‚

#### æ¥å£è§„èŒƒ

```http
GET /api/v1/location/nearest-city?latitude={lat}&longitude={lng}&user_id={user_id}
```

#### è¯·æ±‚å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | èŒƒå›´ | è¯´æ˜ |
|------|------|------|------|------|
| latitude | float | æ˜¯ | -90 ~ 90 | çº¬åº¦ |
| longitude | float | æ˜¯ | -180 ~ 180 | ç»åº¦ |
| user_id | string | å¦ | - | ç”¨æˆ·IDï¼ˆç”¨äºç»Ÿè®¡ï¼‰ |

#### å“åº”æ ¼å¼

```json
{
  "id": 1780,
  "geoname_id": 1816670,
  "name": "Beijing",
  "name_zh": "åŒ—äº¬",
  "latitude": 39.9075,
  "longitude": 116.39723,
  "country_code": "CN",
  "population": 18960744,
  "distance_km": 0.94
}
```

### 2. æŸ¥è¯¢é™„è¿‘åŸå¸‚åˆ—è¡¨

#### æ¥å£è§„èŒƒ

```http
GET /api/v1/location/nearby-cities?latitude={lat}&longitude={lng}&limit={limit}&max_distance_km={distance}&user_id={user_id}
```

#### è¯·æ±‚å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| latitude | float | æ˜¯ | - | çº¬åº¦ |
| longitude | float | æ˜¯ | - | ç»åº¦ |
| limit | int | å¦ | 10 | è¿”å›ç»“æœæ•°é‡ï¼ˆ1-100ï¼‰ |
| max_distance_km | float | å¦ | ä¸é™åˆ¶ | æœ€å¤§è·ç¦»ï¼ˆå…¬é‡Œï¼‰ |
| user_id | string | å¦ | - | ç”¨æˆ·ID |

#### å“åº”æ ¼å¼

```json
[
  {
    "id": 1780,
    "name": "Beijing",
    "name_zh": "åŒ—äº¬",
    "latitude": 39.9075,
    "longitude": 116.39723,
    "distance_km": 0.94
  },
  ...
]
```

---

## ğŸ’» JavaScript å®Œæ•´ç¤ºä¾‹

```javascript
const API_BASE_URL = 'http://123.57.68.4:8000';

// åˆ†ç±»æ˜ å°„è¡¨
const categoryMap = {
  "social_activities": "ç¤¾äº¤æ´»åŠ¨",
  "pets": "å® ç‰©èŒç…§",
  "single_person": "å•äººç…§ç‰‡",
  "foods": "ç¾é£Ÿè®°å½•",
  "travel_scenery": "æ—…è¡Œé£æ™¯",
  "screenshot": "æ‰‹æœºæˆªå›¾",
  "idcard": "è¯ä»¶ç…§",
  "other": "å…¶å®ƒ"
};

/**
 * 1. å¥åº·æ£€æŸ¥
 */
async function checkHealth() {
  const response = await fetch(`${API_BASE_URL}/api/v1/health`);
  return await response.json();
}

/**
 * 2. è®¡ç®—SHA-256å“ˆå¸Œ
 */
async function calculateSHA256(imageFile) {
  const arrayBuffer = await imageFile.arrayBuffer();
  const hashBuffer = await crypto.subtle.digest('SHA-256', arrayBuffer);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
}

/**
 * 3. ç¼©æ”¾å›¾ç‰‡ï¼ˆå¿…é¡»ï¼š1024pxé•¿è¾¹ï¼Œä¿æŒå®½é«˜æ¯”ï¼‰
 */
async function resizeImage(imageFile) {
  return new Promise((resolve, reject) => {
    const img = new Image();
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    
    img.onload = () => {
      const maxSize = 1024;
      let width = img.width;
      let height = img.height;
      
      if (width > maxSize || height > maxSize) {
        if (width > height) {
          height = (height / width) * maxSize;
          width = maxSize;
        } else {
          width = (width / height) * maxSize;
          height = maxSize;
        }
      }
      
      canvas.width = width;
      canvas.height = height;
      ctx.drawImage(img, 0, 0, width, height);
      
      canvas.toBlob((blob) => {
        resolve(new File([blob], imageFile.name, { type: 'image/jpeg' }));
      }, 'image/jpeg', 0.8);
    };
    
    img.onerror = reject;
    img.src = URL.createObjectURL(imageFile);
  });
}

/**
 * 4. æŸ¥è¯¢ç¼“å­˜
 */
async function checkCache(imageHash, userId = null) {
  const headers = { 'Content-Type': 'application/json' };
  if (userId) headers['X-User-ID'] = userId;
  
  const response = await fetch(`${API_BASE_URL}/api/v1/classify/check-cache`, {
    method: 'POST',
    headers: headers,
    body: JSON.stringify({ image_hash: imageHash })
  });
  
  return await response.json();
}

/**
 * 5. ä¸Šä¼ åˆ†ç±»
 */
async function uploadAndClassify(imageFile, imageHash, userId = null) {
  const formData = new FormData();
  formData.append('image', imageFile);
  formData.append('image_hash', imageHash);
  
  const headers = {};
  if (userId) headers['X-User-ID'] = userId;
  
  const response = await fetch(`${API_BASE_URL}/api/v1/classify`, {
    method: 'POST',
    headers: headers,
    body: formData
  });
  
  return await response.json();
}

/**
 * 6. å®¢æˆ·ç«¯åˆ†ç±»æ˜ å°„ï¼ˆå°æ¨¡å‹æ¨ç†ç»“æœï¼‰
 */
function mapDetectionsToCategory(localResult) {
  const { idCardDetections, generalDetections } = localResult;
  
  // 1. æ£€æµ‹åˆ°èº«ä»½è¯
  if (idCardDetections && idCardDetections.length > 0) {
    return 'idcard';
  }
  
  // 2. ç»Ÿè®¡äººæ•°
  const personCount = generalDetections.filter(d => d.className === 'person').length;
  if (personCount === 1) return 'single_person';
  if (personCount > 1) return 'social_activities';
  
  // 3. æ£€æµ‹å® ç‰©
  const petClasses = ['cat', 'dog', 'bird'];
  if (generalDetections.some(d => petClasses.includes(d.className))) {
    return 'pets';
  }
  
  // 4. æ£€æµ‹é£Ÿç‰©
  const foodClasses = ['pizza', 'donut', 'cake', 'sandwich', 'banana', 'apple', 'orange'];
  if (generalDetections.some(d => foodClasses.includes(d.className))) {
    return 'foods';
  }
  
  // 5. æ£€æµ‹ç‰©ä½“å°‘ â†’ é£æ™¯
  if (generalDetections.length <= 3) {
    return 'travel_scenery';
  }
  
  // 6. é»˜è®¤åˆ†ç±»
  return 'other';
}

/**
 * 7. æ‰¹é‡æŸ¥è¯¢ç¼“å­˜
 */
async function batchCheckCache(imageHashes, userId = null) {
  const headers = { 'Content-Type': 'application/json' };
  if (userId) headers['X-User-ID'] = userId;
  
  const response = await fetch(`${API_BASE_URL}/api/v1/classify/batch-check-cache`, {
    method: 'POST',
    headers: headers,
    body: JSON.stringify({ image_hashes: imageHashes })
  });
  
  return await response.json();
}

/**
 * 8. æ‰¹é‡åˆ†ç±»
 */
async function batchClassify(imageFiles, imageHashes = null, userId = null) {
  const formData = new FormData();
  
  // æ·»åŠ å›¾ç‰‡æ–‡ä»¶
  imageFiles.forEach(file => {
    formData.append('images', file);
  });
  
  // æ·»åŠ å“ˆå¸Œåˆ—è¡¨ï¼ˆå¯é€‰ï¼‰
  if (imageHashes && imageHashes.length > 0) {
    formData.append('image_hashes', JSON.stringify(imageHashes));
  }
  
  const headers = {};
  if (userId) headers['X-User-ID'] = userId;
  
  const response = await fetch(`${API_BASE_URL}/api/v1/classify/batch`, {
    method: 'POST',
    headers: headers,
    body: formData
  });
  
  return await response.json();
}

/**
 * 9. å®Œæ•´æ‰¹é‡åˆ†ç±»æµç¨‹ï¼ˆä¼˜åŒ–ç‰ˆï¼‰
 */
async function classifyMultipleImages(imageFiles, userId = null) {
  try {
    console.log(`ğŸ“¦ æ‰¹é‡å¤„ç† ${imageFiles.length} å¼ å›¾ç‰‡...`);
    
    // æ­¥éª¤1: è®¡ç®—æ‰€æœ‰åŸå›¾å“ˆå¸Œ
    const hashes = [];
    for (const file of imageFiles) {
      const hash = await calculateSHA256(file);
      hashes.push(hash);
    }
    console.log(`ğŸ”‘ å·²è®¡ç®— ${hashes.length} ä¸ªå“ˆå¸Œ`);
    
    // æ­¥éª¤2: æ‰¹é‡æŸ¥è¯¢ç¼“å­˜
    console.log('ğŸ” æ‰¹é‡æŸ¥è¯¢ç¼“å­˜...');
    const cacheResult = await batchCheckCache(hashes, userId);
    
    const cachedItems = cacheResult.items.filter(item => item.cached);
    const uncachedHashes = cacheResult.items
      .filter(item => !item.cached)
      .map(item => item.image_hash);
    
    console.log(`âœ… ç¼“å­˜å‘½ä¸­: ${cachedItems.length}/${cacheResult.total}`);
    
    // æ­¥éª¤3: å‡†å¤‡æœªç¼“å­˜çš„å›¾ç‰‡
    const results = new Map();
    
    // æ·»åŠ ç¼“å­˜å‘½ä¸­çš„ç»“æœ
    cachedItems.forEach(item => {
      results.set(item.image_hash, {
        ...item.data,
        category_name: categoryMap[item.data.category],
        from_cache: true
      });
    });
    
    // æ­¥éª¤4: æ‰¹é‡ä¸Šä¼ æœªç¼“å­˜çš„å›¾ç‰‡
    if (uncachedHashes.length > 0) {
      console.log(`â¬†ï¸  ä¸Šä¼  ${uncachedHashes.length} å¼ å›¾ç‰‡...`);
      
      // æ‰¾å‡ºéœ€è¦ä¸Šä¼ çš„å›¾ç‰‡å¹¶ç¼©æ”¾
      const filesToUpload = [];
      const hashesToUpload = [];
      
      for (let i = 0; i < imageFiles.length; i++) {
        if (uncachedHashes.includes(hashes[i])) {
          const resized = await resizeImage(imageFiles[i]);
          filesToUpload.push(resized);
          hashesToUpload.push(hashes[i]);
        }
      }
      
      // æ‰¹é‡ä¸Šä¼ åˆ†ç±»
      const batchResult = await batchClassify(filesToUpload, hashesToUpload, userId);
      
      // å¤„ç†æ‰¹é‡åˆ†ç±»ç»“æœ
      batchResult.items.forEach((item, index) => {
        const hash = hashesToUpload[index];
        if (item.success) {
          const data = item.data;
          
          if (!data.category && data.local_inference_result) {
            // å°æ¨¡å‹æ¨ç†
            const categoryId = mapDetectionsToCategory(data.local_inference_result);
            results.set(hash, {
              category: categoryId,
              category_name: categoryMap[categoryId],
              confidence: 0.8,
              inference_method: 'small_model',
              from_cache: false
            });
          } else {
            // å¤§æ¨¡å‹æ¨ç†
            results.set(hash, {
              category: data.category,
              category_name: categoryMap[data.category],
              confidence: data.confidence,
              description: data.description,
              inference_method: 'llm',
              from_cache: false
            });
          }
        } else {
          results.set(hash, {
            error: item.error,
            success: false
          });
        }
      });
    }
    
    // è¿”å›æŒ‰åŸå§‹é¡ºåºæ’åˆ—çš„ç»“æœ
    return hashes.map(hash => results.get(hash));
    
  } catch (error) {
    console.error('âŒ æ‰¹é‡åˆ†ç±»å¤±è´¥:', error);
    throw error;
  }
}

/**
 * 10. å®Œæ•´åˆ†ç±»æµç¨‹ï¼ˆå•å¼ ï¼‰
 */
async function classifyImage(imageFile, userId = null) {
  try {
    // æ­¥éª¤1: è®¡ç®—åŸå›¾å“ˆå¸Œ
    const imageHash = await calculateSHA256(imageFile);
    console.log(`ğŸ”‘ å“ˆå¸Œ: ${imageHash.substring(0, 16)}...`);
    
    // æ­¥éª¤2: æŸ¥è¯¢ç¼“å­˜
    console.log('ğŸ” æŸ¥è¯¢ç¼“å­˜...');
    const cacheResult = await checkCache(imageHash, userId);
    
    if (cacheResult.cached) {
      console.log('âœ… ç¼“å­˜å‘½ä¸­ï¼æ— éœ€ä¸Šä¼ ');
      return {
        ...cacheResult.data,
        category_name: categoryMap[cacheResult.data.category],
        from_cache: true,
        request_id: cacheResult.request_id
      };
    }
    
    // æ­¥éª¤3: ç¼©æ”¾å›¾ç‰‡ï¼ˆå¿…é¡»ï¼šå¤§æ¨¡å‹æ¥å£é™åˆ¶ï¼‰
    console.log('ğŸ“ ç¼©æ”¾å›¾ç‰‡åˆ°1024px...');
    const resized = await resizeImage(imageFile);
    
    // æ­¥éª¤4: ä¸Šä¼ åˆ†ç±»
    console.log('â¬†ï¸  ä¸Šä¼ å›¾ç‰‡åˆ†ç±»...');
    const result = await uploadAndClassify(resized, imageHash, userId);
    
    if (!result.success) {
      throw new Error(result.error || 'åˆ†ç±»å¤±è´¥');
    }
    
    const data = result.data;
    
    // åˆ¤æ–­æ¨ç†æ–¹å¼
    if (!data.category && data.local_inference_result) {
      // å°æ¨¡å‹æ¨ç† - éœ€è¦å®¢æˆ·ç«¯æ˜ å°„
      console.log('ğŸ¤– å°æ¨¡å‹æ¨ç†ï¼Œè¿›è¡Œå®¢æˆ·ç«¯æ˜ å°„...');
      const categoryId = mapDetectionsToCategory(data.local_inference_result);
      
      return {
        category: categoryId,
        category_name: categoryMap[categoryId],
        confidence: 0.8,
        inference_method: 'small_model',
        from_cache: false,
        request_id: result.request_id,
        processing_time_ms: result.processing_time_ms
      };
    } else {
      // å¤§æ¨¡å‹æ¨ç† - ç›´æ¥ä½¿ç”¨
      console.log('ğŸŒŸ å¤§æ¨¡å‹æ¨ç†æˆåŠŸ');
      return {
        category: data.category,
        category_name: categoryMap[data.category],
        confidence: data.confidence,
        description: data.description,
        inference_method: 'llm',
        from_cache: false,
        request_id: result.request_id,
        processing_time_ms: result.processing_time_ms
      };
    }
    
  } catch (error) {
    console.error('âŒ åˆ†ç±»å¤±è´¥:', error);
    throw error;
  }
}

/**
 * 11. åœ°ç†ä½ç½®æŸ¥è¯¢
 */
async function getNearestCity(latitude, longitude, userId = null) {
  let url = `${API_BASE_URL}/api/v1/location/nearest-city?latitude=${latitude}&longitude=${longitude}`;
  if (userId) url += `&user_id=${userId}`;
  
  const response = await fetch(url);
  const city = await response.json();
  
  // ä¼˜å…ˆä½¿ç”¨ä¸­æ–‡åç§°
  return {
    ...city,
    displayName: city.name_zh || city.name
  };
}

/**
 * ä½¿ç”¨ç¤ºä¾‹
 */
async function example() {
  // 1. æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€
  const health = await checkHealth();
  console.log('æœåŠ¡çŠ¶æ€:', health.status);
  
  // 2. å•å¼ å›¾ç‰‡åˆ†ç±»
  const fileInput = document.getElementById('image-input');
  const imageFile = fileInput.files[0];
  
  const result = await classifyImage(imageFile, 'user-123');
  console.log('åˆ†ç±»ç»“æœ:', result.category_name);
  console.log('ç½®ä¿¡åº¦:', (result.confidence * 100).toFixed(1) + '%');
  console.log('è€—æ—¶:', result.processing_time_ms + 'ms');
  
  // 3. æ‰¹é‡å›¾ç‰‡åˆ†ç±»ï¼ˆä¾‹å¦‚ï¼šç›¸å†Œå¯¼å…¥ï¼‰
  const multiFileInput = document.getElementById('multi-image-input');
  const imageFiles = Array.from(multiFileInput.files);
  
  const results = await classifyMultipleImages(imageFiles, 'user-123');
  results.forEach((result, index) => {
    if (result.success !== false) {
      console.log(`å›¾ç‰‡${index + 1}: ${result.category_name} (${result.confidence})`);
    } else {
      console.log(`å›¾ç‰‡${index + 1}: åˆ†ç±»å¤±è´¥ - ${result.error}`);
    }
  });
  
  // 4. æŸ¥è¯¢åœ°ç†ä½ç½®ï¼ˆå¦‚æœç…§ç‰‡æœ‰GPSä¿¡æ¯ï¼‰
  const city = await getNearestCity(39.9042, 116.4074);
  console.log('æ‹æ‘„åœ°ç‚¹:', city.displayName);
}
```

---

## ğŸ¤– æ··åˆæ¨ç†æœºåˆ¶è¯´æ˜

æœåŠ¡å™¨æ”¯æŒä¸¤ç§æ¨ç†æ–¹å¼ï¼Œä¼šæ ¹æ®é…ç½®è‡ªåŠ¨é€‰æ‹©ï¼š

### æ¨ç†æ–¹å¼å¯¹æ¯”

| ç‰¹æ€§ | å¤§æ¨¡å‹ï¼ˆLLMï¼‰ | å°æ¨¡å‹ï¼ˆONNXï¼‰ |
|------|--------------|---------------|
| **å‡†ç¡®æ€§** | âœ… é«˜ | âš ï¸ ä¸­ç­‰ |
| **é€Ÿåº¦** | âŒ æ…¢ï¼ˆ3-10ç§’ï¼‰ | âœ… å¿«ï¼ˆ< 500msï¼‰ |
| **è´¹ç”¨** | âŒ éœ€è¦APIè´¹ç”¨ | âœ… æ— è´¹ç”¨ |
| **å®¢æˆ·ç«¯å¤„ç†** | âœ… ç›´æ¥ä½¿ç”¨ | âš ï¸ éœ€è¦æ˜ å°„ |

### åˆ¤æ–­æ ‡è¯†

å®¢æˆ·ç«¯é€šè¿‡å“åº”ä¸­çš„ `category` å­—æ®µåˆ¤æ–­ï¼š

```javascript
if (!data.category && data.local_inference_result) {
  // å°æ¨¡å‹æ¨ç† - éœ€è¦å®¢æˆ·ç«¯æ˜ å°„
  const categoryId = mapDetectionsToCategory(data.local_inference_result);
} else {
  // å¤§æ¨¡å‹æ¨ç† - ç›´æ¥ä½¿ç”¨
  const categoryId = data.category;
}
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. å›¾ç‰‡å¤„ç†è¦æ±‚ï¼ˆå¿…é¡»éµå®ˆï¼‰
- **å¿…é¡»ç¼©æ”¾**ï¼šé•¿è¾¹ç¼©æ”¾åˆ°1024pxï¼Œä¿æŒå®½é«˜æ¯”ä¸å˜
- **å¿…é¡»è½¬æ¢æ ¼å¼**ï¼šJPEGæ ¼å¼ï¼Œè´¨é‡80%
- **åŸå› **ï¼šå¤§æ¨¡å‹APIæ¥å£å¯¹å›¾ç‰‡å°ºå¯¸æœ‰ä¸¥æ ¼é™åˆ¶
- **æœ€å¤§å¤§å°**ï¼š10MBï¼ˆåŸå›¾ï¼‰
- **æ”¯æŒæ ¼å¼**ï¼šJPG, PNG, WebP, GIFï¼ˆä¸Šä¼ å‰ä¼šç»Ÿä¸€è½¬ä¸ºJPEGï¼‰

### 2. å“ˆå¸Œè®¡ç®—
- **å¿…é¡»ä¼ é€’**ï¼š`image_hash` æ˜¯å¿…å¡«å‚æ•°
- **è®¡ç®—æ—¶æœº**ï¼šåœ¨ç¼©æ”¾å‰è®¡ç®—åŸå›¾å“ˆå¸Œ
- **ç”¨é€”**ï¼šç”¨äºç¼“å­˜å»é‡å’ŒæŸ¥è¯¢

### 3. é”™è¯¯å¤„ç†
- **è¶…æ—¶è®¾ç½®**ï¼šå»ºè®®30ç§’
- **é‡è¯•æœºåˆ¶**ï¼šç½‘ç»œé”™è¯¯å¯ä»¥é‡è¯•
- **å¼‚å¸¸æ•è·**ï¼šå§‹ç»ˆæ·»åŠ try-catch

### 4. æ€§èƒ½ä¼˜åŒ–
- **å…ˆæŸ¥ç¼“å­˜**ï¼šå¯ä»¥çœç•¥ç¼©æ”¾æ“ä½œï¼ˆç¼“å­˜å‘½ä¸­ç‡çº¦50%æ—¶æ€§èƒ½æå‡37.5%ï¼‰
- **å‹ç¼©ä¼ è¾“**ï¼šç¼©æ”¾åçš„å›¾ç‰‡é€šå¸¸åªæœ‰200KBå·¦å³
- **å¹¶å‘æ§åˆ¶**ï¼šé¿å…åŒæ—¶ä¸Šä¼ è¿‡å¤šå›¾ç‰‡

### 5. æ‰¹é‡æ“ä½œå»ºè®®
- **æ‰¹é‡ç¼“å­˜æŸ¥è¯¢**ï¼šæœ€å¤š100ä¸ªå“ˆå¸Œï¼Œå»ºè®®åˆ†æ‰¹æŸ¥è¯¢
- **æ‰¹é‡åˆ†ç±»**ï¼šæœ€å¤š20å¼ å›¾ç‰‡ï¼Œå»ºè®®æŒ‰æ‰¹æ¬¡å¤„ç†
- **ä¼˜åŒ–ç­–ç•¥**ï¼šå…ˆæ‰¹é‡æŸ¥ç¼“å­˜ï¼Œåªä¸Šä¼ æœªç¼“å­˜çš„å›¾ç‰‡
- **é”™è¯¯å¤„ç†**ï¼šæ‰¹é‡æ“ä½œä¸­éƒ¨åˆ†å¤±è´¥ä¸å½±å“æ•´ä½“ç»“æœ

---

## ğŸ“ è·å–å¸®åŠ©

- **APIåœ¨çº¿æ–‡æ¡£**ï¼šhttp://123.57.68.4:8000/docs
- **ç®¡ç†åå°**ï¼šhttp://123.57.68.4:8000/
- **æŠ€æœ¯æ”¯æŒ**ï¼šæŸ¥çœ‹é¡¹ç›®ä¸­çš„å…¶ä»–æŠ€æœ¯æ–‡æ¡£

---

## ğŸ¨ å›¾åƒç¼–è¾‘æœåŠ¡

### æäº¤ç¼–è¾‘ä»»åŠ¡

#### æ¥å£è§„èŒƒ

```http
POST /api/v1/image-edit/submit
Content-Type: multipart/form-data
X-User-ID: {user_id}  // å¯é€‰
```

#### è¯·æ±‚å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| images | File[] | æ˜¯ | å›¾ç‰‡æ–‡ä»¶æ•°ç»„ï¼ˆ1-9å¼ ï¼‰ |
| edit_type | string | æ˜¯ | ç¼–è¾‘ç±»å‹ï¼ˆå¦‚ "enhance"ï¼‰ |
| edit_params | string | æ˜¯ | ç¼–è¾‘å‚æ•°ï¼ˆJSONå­—ç¬¦ä¸²ï¼‰ |

#### è¯·æ±‚ç¤ºä¾‹

```javascript
async function submitImageEdit(imageFiles, userId = null) {
  const formData = new FormData();
  
  // æ·»åŠ å›¾ç‰‡æ–‡ä»¶ï¼ˆ1-9å¼ ï¼‰
  imageFiles.forEach(file => {
    formData.append('images', file);
  });
  
  // ç¼–è¾‘ç±»å‹
  formData.append('edit_type', 'enhance');
  
  // ç¼–è¾‘å‚æ•°ï¼ˆJSONå­—ç¬¦ä¸²ï¼‰
  const editParams = {
    prompt: 'ä¿®å¤é¢éƒ¨ç‘•ç–µå’Œçš±çº¹ï¼Œæäº®è‚¤è‰²ï¼Œä¿æŒäººç‰©åŸè²Œä¸å˜'
  };
  formData.append('edit_params', JSON.stringify(editParams));
  
  const headers = {};
  if (userId) headers['X-User-ID'] = userId;
  
  const response = await fetch(`${API_BASE_URL}/api/v1/image-edit/submit`, {
    method: 'POST',
    headers: headers,
    body: formData
  });
  
  return await response.json();
}
```

#### å“åº”æ ¼å¼

```json
{
  "success": true,
  "task_id": "task_20250124_abc123",
  "total_images": 6,
  "estimated_time_ms": 162000
}
```

**å­—æ®µè¯´æ˜**ï¼š
- `task_id`ï¼šä»»åŠ¡IDï¼ˆç”¨äºåç»­æŸ¥è¯¢ï¼‰
- `total_images`ï¼šæ€»å›¾ç‰‡æ•°
- `estimated_time_ms`ï¼šé¢„ä¼°å¤„ç†æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰

#### æ³¨æ„äº‹é¡¹

1. **å›¾ç‰‡æ•°é‡é™åˆ¶**ï¼š1-9å¼ ï¼ˆä¸å¾®ä¿¡æœ‹å‹åœˆä¹å®«æ ¼ä¸€è‡´ï¼‰
2. **å›¾ç‰‡æ ¼å¼**ï¼šä½¿ç”¨åŸå›¾ï¼Œä¸å‹ç¼©ï¼ˆç¡®ä¿ç¼–è¾‘æ•ˆæœï¼‰
3. **å¤„ç†æ—¶é—´**ï¼šå•å¼ çº¦18ç§’ï¼Œæ‰¹é‡è‡ªåŠ¨åˆ†æ‰¹å¤„ç†
4. **å¼‚æ­¥å¤„ç†**ï¼šæäº¤åç«‹å³è¿”å›task_idï¼Œéœ€è½®è¯¢æŸ¥è¯¢çŠ¶æ€

---

### æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€

#### æ¥å£è§„èŒƒ

```http
GET /api/v1/image-edit/task/{task_id}
```

#### è¯·æ±‚ç¤ºä¾‹

```javascript
async function getEditTaskStatus(taskId) {
  const response = await fetch(`${API_BASE_URL}/api/v1/image-edit/task/${taskId}`);
  return await response.json();
}
```

#### å“åº”æ ¼å¼

**å¤„ç†ä¸­**ï¼š
```json
{
  "task_id": "task_20250124_abc123",
  "user_id": "user123",
  "edit_type": "enhance",
  "edit_params": {
    "prompt": "ä¿®å¤é¢éƒ¨ç‘•ç–µå’Œçš±çº¹ï¼Œæäº®è‚¤è‰²ï¼Œä¿æŒäººç‰©åŸè²Œä¸å˜"
  },
  "total_images": 6,
  "completed_images": 3,
  "progress": 50.0,
  "status": "processing",
  "results": [
    {
      "index": 0,
      "filename": "image1.jpg",
      "status": "completed",
      "result_url": "http://123.57.68.4:8000/images/edited/img_xxx.png"
    },
    {
      "index": 1,
      "filename": "image2.jpg",
      "status": "completed",
      "result_url": "http://123.57.68.4:8000/images/edited/img_yyy.png"
    }
  ],
  "created_at": "2025-01-24T10:00:00",
  "updated_at": "2025-01-24T10:00:30"
}
```

**å·²å®Œæˆ**ï¼š
```json
{
  "task_id": "task_20250124_abc123",
  "status": "completed",
  "progress": 100.0,
  "results": [
    {
      "index": 0,
      "filename": "image1.jpg",
      "status": "completed",
      "result_url": "http://123.57.68.4:8000/images/edited/img_xxx.png"
    },
    {
      "index": 1,
      "filename": "image2.jpg",
      "status": "completed",
      "result_url": "http://123.57.68.4:8000/images/edited/img_yyy.png"
    }
  ]
}
```

**çŠ¶æ€è¯´æ˜**ï¼š
- `pending`ï¼šå¾…å¤„ç†
- `processing`ï¼šå¤„ç†ä¸­
- `completed`ï¼šå·²å®Œæˆ
- `failed`ï¼šå¤„ç†å¤±è´¥

---

### å®Œæ•´ä½¿ç”¨ç¤ºä¾‹

```javascript
/**
 * å›¾åƒç¼–è¾‘å®Œæ•´æµç¨‹
 */
async function editImages(imageFiles, userId = null) {
  try {
    // 1. æäº¤ç¼–è¾‘ä»»åŠ¡
    console.log('ğŸ“¤ æäº¤ç¼–è¾‘ä»»åŠ¡...');
    const submitResult = await submitImageEdit(imageFiles, userId);
    
    if (!submitResult.success) {
      throw new Error('æäº¤å¤±è´¥');
    }
    
    const taskId = submitResult.task_id;
    const estimatedTime = submitResult.estimated_time_ms;
    
    console.log(`âœ… ä»»åŠ¡å·²æäº¤: ${taskId}`);
    console.log(`â±ï¸  é¢„ä¼°æ—¶é—´: ${(estimatedTime / 1000).toFixed(1)}ç§’`);
    
    // 2. è½®è¯¢æŸ¥è¯¢çŠ¶æ€
    console.log('ğŸ”„ æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€...');
    
    const pollInterval = 2000; // 2ç§’
    const maxAttempts = Math.ceil(estimatedTime / pollInterval) + 10;
    let attempts = 0;
    
    while (attempts < maxAttempts) {
      const status = await getEditTaskStatus(taskId);
      
      console.log(`ğŸ“Š è¿›åº¦: ${status.progress.toFixed(1)}% (${status.completed_images}/${status.total_images})`);
      
      if (status.status === 'completed') {
        console.log('âœ… ç¼–è¾‘å®Œæˆï¼');
        return status.results;
      }
      
      if (status.status === 'failed') {
        throw new Error('ç¼–è¾‘å¤±è´¥');
      }
      
      // ç­‰å¾…åç»§ç»­æŸ¥è¯¢
      await new Promise(resolve => setTimeout(resolve, pollInterval));
      attempts++;
    }
    
    throw new Error('æŸ¥è¯¢è¶…æ—¶');
    
  } catch (error) {
    console.error('âŒ ç¼–è¾‘å¤±è´¥:', error);
    throw error;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
async function example() {
  const fileInput = document.getElementById('image-input');
  const imageFiles = Array.from(fileInput.files);
  
  // é™åˆ¶æœ€å¤š9å¼ 
  const filesToEdit = imageFiles.slice(0, 9);
  
  try {
    const results = await editImages(filesToEdit, 'user-123');
    
    results.forEach((result, index) => {
      if (result.status === 'completed') {
        console.log(`å›¾ç‰‡${index + 1}: ${result.result_url}`);
        // æ˜¾ç¤ºç¼–è¾‘åçš„å›¾ç‰‡
        const img = document.createElement('img');
        img.src = result.result_url;
        document.body.appendChild(img);
      }
    });
    
  } catch (error) {
    console.error('å¤„ç†å¤±è´¥:', error);
  }
}
```

#### è½®è¯¢ç­–ç•¥å»ºè®®

1. **åˆå§‹é—´éš”**ï¼šæäº¤åç­‰å¾…2-3ç§’å†å¼€å§‹æŸ¥è¯¢
2. **æŸ¥è¯¢é¢‘ç‡**ï¼šæ¯2ç§’æŸ¥è¯¢ä¸€æ¬¡
3. **è¶…æ—¶æ—¶é—´**ï¼šé¢„ä¼°æ—¶é—´ + 30ç§’
4. **ç”¨æˆ·ä½“éªŒ**ï¼š
   - æ˜¾ç¤ºè¿›åº¦ç™¾åˆ†æ¯”
   - æ˜¾ç¤ºå·²å®Œæˆ/æ€»æ•°é‡
   - æä¾›å–æ¶ˆæ“ä½œï¼ˆå¯é€‰ï¼‰

---

### ç¼“å­˜æœºåˆ¶

å›¾åƒç¼–è¾‘æœåŠ¡æ”¯æŒ**æ™ºèƒ½ç¼“å­˜**ï¼š

- **ç›¸åŒå›¾ç‰‡ + ç›¸åŒæç¤ºè¯**ï¼šè‡ªåŠ¨è¿”å›ç¼“å­˜ç»“æœ
- **ç¼“å­˜å‘½ä¸­**ï¼šæ— éœ€è°ƒç”¨é˜¿é‡Œäº‘APIï¼Œç§’çº§è¿”å›
- **ç¼“å­˜æœªå‘½ä¸­**ï¼šæ­£å¸¸è°ƒç”¨APIå¤„ç†

**æ³¨æ„äº‹é¡¹**ï¼š
- ç¼“å­˜åŸºäºå›¾ç‰‡å“ˆå¸Œå’Œæç¤ºè¯
- ç¼–è¾‘å‚æ•°ä¸åŒä¼šç”Ÿæˆä¸åŒçš„ç¼“å­˜ç»“æœ
- ç¼“å­˜æ—¶é—´ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚å¯é…ç½®æ¸…ç†ç­–ç•¥

---

## ğŸ” å¾®ä¿¡è®¤è¯ä¸é¢åº¦ç®¡ç†

### ç”Ÿæˆå¾®ä¿¡å…¬ä¼—å·äºŒç»´ç ï¼ˆåŸºäºclient_idï¼‰

#### æ¥å£è§„èŒƒ

```http
POST /api/v1/auth/wechat/qrcode
Content-Type: application/json
```

#### è¯·æ±‚å‚æ•°

```json
{
  "client_id": "PC_123456"  // å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†
}
```

**client_idè¯´æ˜**ï¼š
- å»ºè®®ä½¿ç”¨è®¾å¤‡IDæˆ–ç”¨æˆ·IDç”Ÿæˆå”¯ä¸€æ ‡è¯†
- PCç«¯å’Œç§»åŠ¨ç«¯å¯ä½¿ç”¨ä¸åŒçš„client_id
- åŒä¸€ä¸ªå¾®ä¿¡ç”¨æˆ·çš„ä¸åŒclient_idä¼šæ˜ å°„åˆ°åŒä¸€ä¸ªopenid

#### å“åº”æ ¼å¼

```json
{
  "success": true,
  "qrcode_url": "https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=xxx",
  "ticket": "xxx",
  "client_id": "PC_123456",
  "scene_id": 1234567890,
  "expire_seconds": 2592000
}
```

#### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| success | boolean | æ˜¯å¦æˆåŠŸ |
| qrcode_url | string | äºŒç»´ç å›¾ç‰‡URLï¼ˆå¯ç›´æ¥ç”¨äºimgæ ‡ç­¾ï¼‰ |
| ticket | string | äºŒç»´ç ç¥¨æ® |
| client_id | string | å®¢æˆ·ç«¯ID |
| scene_id | int | åœºæ™¯å€¼ï¼ˆç”¨äºè¯†åˆ«æ‰«ç æ¥æºï¼‰ |
| expire_seconds | int | äºŒç»´ç æœ‰æ•ˆæœŸï¼ˆç§’ï¼Œé»˜è®¤30å¤©ï¼‰ |

#### JavaScriptç¤ºä¾‹

```javascript
/**
 * 1. ç”ŸæˆäºŒç»´ç å¹¶æ˜¾ç¤º
 */
async function generateQRCode() {
  // ç”Ÿæˆå®¢æˆ·ç«¯å”¯ä¸€IDï¼ˆä¾‹å¦‚ï¼šä½¿ç”¨localStorageå­˜å‚¨ï¼‰
  let clientId = localStorage.getItem('client_id');
  
  if (!clientId) {
    // ç”Ÿæˆæ–°çš„å®¢æˆ·ç«¯ID
    clientId = 'PC_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    localStorage.setItem('client_id', clientId);
  }
  
  try {
    const response = await fetch(`${API_BASE_URL}/api/v1/auth/wechat/qrcode`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ client_id: clientId })
    });
    
    const result = await response.json();
    
    if (result.success) {
      // æ˜¾ç¤ºäºŒç»´ç 
      document.getElementById('qrcode-img').src = result.qrcode_url;
      console.log('âœ… äºŒç»´ç ç”ŸæˆæˆåŠŸ');
      
      // å¼€å§‹è½®è¯¢æ£€æŸ¥å…³æ³¨çŠ¶æ€
      startPollingFollowStatus(clientId);
      
    } else {
      console.error('ç”ŸæˆäºŒç»´ç å¤±è´¥');
    }
    
  } catch (error) {
    console.error('ç”ŸæˆäºŒç»´ç å¼‚å¸¸:', error);
  }
}

/**
 * 2. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²å…³æ³¨å…¬ä¼—å·
 */
async function checkFollowStatus(clientId) {
  try {
    const response = await fetch(
      `${API_BASE_URL}/api/v1/auth/wechat/check-follow?client_id=${clientId}`
    );
    
    return await response.json();
    
  } catch (error) {
    console.error('æ£€æŸ¥å…³æ³¨çŠ¶æ€å¤±è´¥:', error);
    return { subscribed: false };
  }
}

/**
 * 3. è½®è¯¢æ£€æŸ¥å…³æ³¨çŠ¶æ€
 */
function startPollingFollowStatus(clientId) {
  const pollInterval = 2000; // 2ç§’è½®è¯¢ä¸€æ¬¡
  let attempts = 0;
  const maxAttempts = 150; // æœ€å¤š5åˆ†é’Ÿ
  
  const timer = setInterval(async () => {
    attempts++;
    
    if (attempts > maxAttempts) {
      clearInterval(timer);
      console.log('â±ï¸  è¶…æ—¶ï¼šè¯·é‡æ–°ç”ŸæˆäºŒç»´ç ');
      return;
    }
    
    const result = await checkFollowStatus(clientId);
    
    if (result.subscribed) {
      clearInterval(timer);
      // å·²å…³æ³¨ï¼ˆä¸è¿”å›openidï¼‰ï¼Œä»…è®°å½•å®Œæˆæ—¶é—´
      localStorage.setItem('followed_at', result.completed_at || '');
      console.log('âœ… ç”¨æˆ·å·²å…³æ³¨å…¬ä¼—å·');
      
      // éšè—äºŒç»´ç ï¼Œæ˜¾ç¤ºæˆåŠŸæç¤º
      document.getElementById('qrcode-container').style.display = 'none';
      document.getElementById('success-message').style.display = 'block';
      
      // è·³è½¬åˆ°ä¸»é¡µæˆ–åˆ·æ–°é¡µé¢
      setTimeout(() => {
        window.location.href = '/main';
      }, 2000);
    } else {
      console.log(`ğŸ”„ ç­‰å¾…å…³æ³¨... (${attempts}/${maxAttempts})`);
    }
    
  }, pollInterval);
}
```

---

### æŸ¥è¯¢ä¼šå‘˜çŠ¶æ€ï¼ˆåŸºäºclient_idï¼‰

#### æ¥å£è§„èŒƒ

```http
GET /api/v1/user/member-status?client_id={client_id}
```

> å…¥å‚ï¼šQueryå‚æ•° `client_id`ï¼ˆå¿…å¡«ï¼‰

#### å“åº”æ ¼å¼

```json
{
  "success": true,
  "is_member": true,
  "member_expire_at": "2025-01-01 00:00:00"
}
```

---

### æŸ¥è¯¢ç”¨æˆ·é¢åº¦ï¼ˆåŸºäºclient_idï¼‰

#### æ¥å£è§„èŒƒ

```http
GET /api/v1/user/credits?client_id={client_id}
```

> å…¥å‚ï¼šQueryå‚æ•° `client_id`ï¼ˆå¿…å¡«ï¼‰

#### å“åº”æ ¼å¼

```json
{
  "success": true,
  "success": true,
  "total_credits": 100,
  "used_credits": 35,
  "remaining_credits": 65,
  "is_member": true,
  "member_expire_at": "2025-01-01 00:00:00"
}
```

#### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| total_credits | int | æ€»é¢åº¦ï¼ˆå¼ ï¼‰ |
| used_credits | int | å·²ä½¿ç”¨é¢åº¦ï¼ˆå¼ ï¼‰ |
| remaining_credits | int | å‰©ä½™é¢åº¦ï¼ˆå¼ ï¼‰ |

#### JavaScriptç¤ºä¾‹ï¼ˆclient_idï¼‰

```javascript
/**
 * æŸ¥è¯¢ç”¨æˆ·é¢åº¦
 */
async function getUserCredits(clientId) {
  const response = await fetch(`${API_BASE_URL}/api/v1/user/credits?client_id=${encodeURIComponent(clientId)}`);
  return await response.json();
}

// ä½¿ç”¨ç¤ºä¾‹
async function displayUserCredits() {
  try {
    const clientId = localStorage.getItem('client_id');
    const result = await getUserCredits(clientId);
    const credits = result;
    
    console.log(`æ€»é¢åº¦: ${credits.total_credits}å¼ `);
    console.log(`å·²ä½¿ç”¨: ${credits.used_credits}å¼ `);
    console.log(`å‰©ä½™: ${credits.remaining_credits}å¼ `);
    
    // æ›´æ–°UI
    document.getElementById('credits-display').innerText = 
      `å‰©ä½™ ${credits.remaining_credits} å¼ `;
      
  } catch (error) {
    console.error('æŸ¥è¯¢é¢åº¦å¤±è´¥:', error);
  }
}
```

---

### å›¾åƒç¼–è¾‘æœåŠ¡é›†æˆé¢åº¦æ£€æŸ¥

æäº¤å›¾åƒç¼–è¾‘ä»»åŠ¡æ—¶ï¼Œéœ€è¦ä¼ å…¥openidç”¨äºé¢åº¦æ£€æŸ¥å’Œç®¡ç†ã€‚

#### ä¿®æ”¹åçš„æäº¤æ¥å£

```http
POST /api/v1/image-edit/submit
Content-Type: multipart/form-data
X-WeChat-OpenID: {openid}  // æ–°å¢å¿…å¡«
```

#### è¯·æ±‚å¤´

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| X-WeChat-OpenID | string | æ˜¯ | å¾®ä¿¡openidï¼ˆç”¨äºé¢åº¦ç®¡ç†ï¼‰ |

#### å“åº”æ ¼å¼

**é¢åº¦ä¸è¶³**ï¼š
```json
{
  "success": false,
  "error": "é¢åº¦ä¸è¶³ï¼šå‰©ä½™65å¼ ï¼Œéœ€è¦9å¼ "
}
```

**æ­£å¸¸å“åº”**ï¼š
```json
{
  "success": true,
  "task_id": "task_20250124_abc123",
  "total_images": 6,
  "estimated_time_ms": 108000
}
```

#### ä¿®æ”¹åçš„JavaScriptç¤ºä¾‹

```javascript
/**
 * æäº¤å›¾åƒç¼–è¾‘ä»»åŠ¡ï¼ˆå¸¦é¢åº¦æ£€æŸ¥ï¼‰
 */
async function submitImageEdit(imageFiles) {
  const openid = localStorage.getItem('wechat_openid');
  
  if (!openid) {
    throw new Error('è¯·å…ˆæˆæƒç™»å½•');
  }
  
  const formData = new FormData();
  
  // æ·»åŠ å›¾ç‰‡æ–‡ä»¶ï¼ˆ1-9å¼ ï¼‰
  imageFiles.forEach(file => {
    formData.append('images', file);
  });
  
  // ç¼–è¾‘ç±»å‹
  formData.append('edit_type', 'enhance');
  
  // ç¼–è¾‘å‚æ•°
  const editParams = {
    prompt: 'ä¿®å¤é¢éƒ¨ç‘•ç–µå’Œçš±çº¹ï¼Œæäº®è‚¤è‰²ï¼Œä¿æŒäººç‰©åŸè²Œä¸å˜'
  };
  formData.append('edit_params', JSON.stringify(editParams));
  
  // ä¼ å…¥openidç”¨äºé¢åº¦æ£€æŸ¥
  const response = await fetch(`${API_BASE_URL}/api/v1/image-edit/submit`, {
    method: 'POST',
    headers: {
      'X-WeChat-OpenID': openid  // ä¼ å…¥openid
    },
    body: formData
  });
  
  return await response.json();
}

/**
 * å®Œæ•´æµç¨‹ï¼šå…ˆæ£€æŸ¥é¢åº¦ï¼Œå†æäº¤ä»»åŠ¡
 */
async function editImagesWithCreditsCheck(imageFiles) {
  try {
    // 1. æ£€æŸ¥ç”¨æˆ·é¢åº¦
    const creditsResult = await getUserCredits();
    const remainingCredits = creditsResult.data.remaining_credits;
    
    // 2. æ¯”è¾ƒé¢åº¦ä¸å›¾ç‰‡æ•°é‡
    if (remainingCredits < imageFiles.length) {
      alert(`é¢åº¦ä¸è¶³ï¼šå‰©ä½™${remainingCredits}å¼ ï¼Œéœ€è¦${imageFiles.length}å¼ \n\nè¯·å…³æ³¨å¾®ä¿¡å…¬ä¼—å·è·å–æ›´å¤šé¢åº¦ï¼`);
      return;
    }
    
    // 3. æ˜¾ç¤ºå‰©ä½™é¢åº¦
    console.log(`âœ… å‰©ä½™é¢åº¦å……è¶³ï¼š${remainingCredits}å¼ `);
    
    // 4. æäº¤ç¼–è¾‘ä»»åŠ¡
    const submitResult = await submitImageEdit(imageFiles);
    
    if (!submitResult.success) {
      if (submitResult.error.includes('é¢åº¦ä¸è¶³')) {
        alert(submitResult.error + '\n\nè¯·å…³æ³¨å¾®ä¿¡å…¬ä¼—å·è·å–æ›´å¤šé¢åº¦ï¼');
      }
      throw new Error(submitResult.error);
    }
    
    console.log('âœ… ä»»åŠ¡å·²æäº¤:', submitResult.task_id);
    return submitResult;
    
  } catch (error) {
    console.error('âŒ æäº¤å¤±è´¥:', error);
    throw error;
  }
}
```

---

### é¢åº¦ç®¡ç†è¯´æ˜ï¼ˆå®¢æˆ·ç«¯ï¼‰

#### é¢åº¦è§„åˆ™

1. **é¦–æ¬¡å…³æ³¨**ï¼šè‡ªåŠ¨åˆ†é…åˆå§‹é¢åº¦ï¼ˆä»¥æœåŠ¡ç«¯é…ç½®ä¸ºå‡†ï¼‰
2. **æ¯æ¬¡ä½¿ç”¨**ï¼šæˆåŠŸçš„å›¾åƒå¢å¼ºç»“æœæŒ‰å¼ æ‰£å‡
3. **é¢åº¦æ¶ˆè€—**ï¼š
   - 1å¼ å›¾ç‰‡ = 1å¼ é¢åº¦
   - ä»»åŠ¡æäº¤åç«‹å³æ‰£å‡ï¼ˆåŒ…æ‹¬å¤±è´¥çš„å›¾ç‰‡ï¼‰
4. **é¢åº¦ç”¨å°½**ï¼šæç¤ºè´­ä¹°é¢åº¦æˆ–å¼€é€šä¼šå‘˜ï¼ˆä»¥ä¸šåŠ¡ç­–ç•¥ä¸ºå‡†ï¼‰

#### é¢åº¦å±•ç¤ºå»ºè®®

å®¢æˆ·ç«¯åº”è¯¥åœ¨ä»¥ä¸‹ä½ç½®å±•ç¤ºé¢åº¦ä¿¡æ¯ï¼š

1. **é¦–é¡µ**ï¼šæ˜¾ç¤ºå‰©ä½™é¢åº¦
   ```
   å‰©ä½™é¢åº¦ï¼š65 / 100 å¼ 
   ```

2. **æäº¤å‰**ï¼šæ£€æŸ¥å¹¶æç¤º
   ```
   å‰©ä½™é¢åº¦ï¼š65å¼ 
   æœ¬æ¬¡ç¼–è¾‘ï¼š6å¼ 
   ç¼–è¾‘åå‰©ä½™ï¼š59å¼ 
   ```

3. **é¢åº¦ä¸è¶³**ï¼šå¼•å¯¼å…³æ³¨
   ```
   é¢åº¦ä¸è¶³ï¼è¯·å…³æ³¨å¾®ä¿¡å…¬ä¼—å·è·å–æ›´å¤šé¢åº¦
   [å…³æ³¨å…¬ä¼—å·]
   ```

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv4.0  
**æœ€åæ›´æ–°**ï¼š2025-10-27

**æ›´æ–°å†…å®¹**ï¼š
- æ–°å¢æ‰¹é‡æŸ¥è¯¢ç¼“å­˜æ¥å£ï¼ˆæœ€å¤š100ä¸ªå“ˆå¸Œï¼‰
- æ–°å¢æ‰¹é‡å›¾ç‰‡åˆ†ç±»æ¥å£ï¼ˆæœ€å¤š20å¼ å›¾ç‰‡ï¼‰
- æ–°å¢æ‰¹é‡æ“ä½œçš„å®Œæ•´JavaScriptç¤ºä¾‹
- æ–°å¢æ‰¹é‡æ“ä½œçš„æœ€ä½³å®è·µå»ºè®®
- è¡¥å……æ‰¹é‡åˆ†ç±»æ¥å£æ”¯æŒå°æ¨¡å‹æ¨ç†çš„è¯´æ˜å’Œç¤ºä¾‹
- æ–°å¢å›¾åƒç¼–è¾‘APIå®Œæ•´æ–‡æ¡£ï¼ˆæäº¤ä»»åŠ¡ã€æŸ¥è¯¢çŠ¶æ€ã€å®Œæ•´ç¤ºä¾‹ï¼‰
- **æ–°å¢å¾®ä¿¡è®¤è¯ä¸é¢åº¦ç®¡ç†æ¥å£ï¼ˆæˆæƒç™»å½•ã€æŸ¥è¯¢é¢åº¦ï¼‰**
- **å›¾åƒç¼–è¾‘æ¥å£å¢åŠ é¢åº¦æ£€æŸ¥å’Œæ‰£é™¤åŠŸèƒ½**
