# å¾®ä¿¡æ”¯ä»˜æµ‹è¯•æŒ‡å—

## ğŸ“‹ æµ‹è¯•å‰å‡†å¤‡

### 1. ç¡®è®¤å•†æˆ·å¹³å°é…ç½®

ç™»å½• [å¾®ä¿¡æ”¯ä»˜å•†æˆ·å¹³å°](https://pay.weixin.qq.com/)ï¼Œæ£€æŸ¥ï¼š

- âœ… **å•†æˆ·å·**: `1731030428`
- âœ… **APIå¯†é’¥**: å·²é…ç½®
- âœ… **æˆæƒç›®å½•**: `https://www.xintuxiangce.top/api/v1/`
- âœ… **å›è°ƒURL**: `https://www.xintuxiangce.top/api/v1/payment/notify`

### 2. å¼€é€šJSAPIæ”¯ä»˜

åœ¨å•†æˆ·å¹³å°ä¸­ï¼š

1. è¿›å…¥ **äº§å“ä¸­å¿ƒ** > **æˆ‘çš„äº§å“**
2. æŸ¥çœ‹æ˜¯å¦æœ‰ **JSAPIæ”¯ä»˜** äº§å“
3. å¦‚æœæ²¡æœ‰ï¼Œç‚¹å‡» **å¼€é€š**
4. æŒ‰ç…§æç¤ºå®Œæˆå¼€é€šæµç¨‹

## ğŸ§ª æµ‹è¯•æ”¯ä»˜åŠŸèƒ½

### æ–¹å¼1ï¼šç›´æ¥æµ‹è¯•åˆ›å»ºè®¢å•æ¥å£

ä½¿ç”¨Postmanæˆ–curlæµ‹è¯•æ¥å£ï¼ˆéœ€è¦å…ˆå…³æ³¨å…¬ä¼—å·è·å–openidï¼‰ï¼š

```bash
curl -X POST https://www.xintuxiangce.top/api/v1/payment/create-order \
  -H "Content-Type: application/json" \
  -H "X-WeChat-OpenID: your_openid_here" \
  -d '{
    "order_type": "member",
    "credits_amount": null
  }'
```

### æ–¹å¼2ï¼šæ²™ç®±ç¯å¢ƒæµ‹è¯•ï¼ˆæ¨èï¼‰

åœ¨æ­£å¼ç¯å¢ƒæµ‹è¯•å‰ï¼Œå»ºè®®å…ˆåœ¨æ²™ç®±ç¯å¢ƒæµ‹è¯•ï¼š

1. åœ¨å•†æˆ·å¹³å°è¿›å…¥ **å¼€å‘é…ç½®** > **æ²™ç®±ç¯å¢ƒ**
2. è·å–æ²™ç®±ç¯å¢ƒçš„APIå¯†é’¥
3. ä½¿ç”¨æ²™ç®±å‚æ•°æµ‹è¯•

## ğŸ“ æµ‹è¯•æµç¨‹

1. **è°ƒç”¨åˆ›å»ºè®¢å•æ¥å£**
   - POST `/api/v1/payment/create-order`
   - è¿”å› `payment_params`

2. **åœ¨å‰ç«¯è°ƒèµ·å¾®ä¿¡æ”¯ä»˜**
   ```javascript
   WeixinJSBridge.invoke('getBrandWCPayRequest', {
       appId: payment_params.appId,
       timeStamp: payment_params.timeStamp,
       nonceStr: payment_params.nonceStr,
       package: payment_params.package,
       signType: payment_params.signType,
       paySign: payment_params.paySign
   }, function(res) {
       if (res.err_msg == "get_brand_wcpay_request:ok") {
           // æ”¯ä»˜æˆåŠŸ
       }
   });
   ```

3. **éªŒè¯å›è°ƒ**
   - æ”¯ä»˜æˆåŠŸåï¼Œå¾®ä¿¡ä¼šå›è°ƒ `/api/v1/payment/notify`
   - æ£€æŸ¥è®¢å•çŠ¶æ€æ˜¯å¦æ›´æ–°

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¿…é¡»å…³æ³¨å…¬ä¼—å·**ï¼šJSAPIæ”¯ä»˜éœ€è¦åœ¨å…¬ä¼—å·å†…å®Œæˆ
2. **æµ‹è¯•è´¦å·**ï¼šä½¿ç”¨ä½ çš„å¾®ä¿¡æ‰«ç å…³æ³¨åæµ‹è¯•
3. **çœŸå®é‡‘é¢**ï¼šæ­£å¼ç¯å¢ƒä¼šäº§ç”ŸçœŸå®æ‰£è´¹ï¼Œå»ºè®®å…ˆç”¨1åˆ†é’±æµ‹è¯•

## ğŸ” å¸¸è§é—®é¢˜

**Q: æç¤º"æœªå¼€é€šJSAPIæ”¯ä»˜"æ€ä¹ˆåŠï¼Ÿ**
A: éœ€è¦å…ˆåœ¨å•†æˆ·å¹³å°ç”³è¯·å¼€é€šJSAPIæ”¯ä»˜äº§å“

**Q: æ”¯ä»˜å›è°ƒæ²¡æ”¶åˆ°ï¼Ÿ**
A: æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—ï¼Œç¡®è®¤å›è°ƒURLæ˜¯å¦å¯è®¿é—®

**Q: ç­¾åéªŒè¯å¤±è´¥ï¼Ÿ**
A: æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®é…ç½®

